<h1>Selecionar veículo de saúde</h1>
<head>
	<meta charset="utf-8"/>

	<title>Google Maps</title>
	<style>
	#map {
		width: 512px;
		height: 512px;
	}
	</style>
</head>
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
<script type="text/javascript">
  var cidade = new google.maps.LatLng("-22.110134","-45.052872");
  var veiculos = new Array();
  
  <% @veiculos_de_saude.each do |veiculo|  %>
  veiculos.push(new google.maps.LatLng(<%= veiculo.latitude %>,<%= veiculo.longitude %>));
  <% end %>

  var markers = [];
  var iterator = 0;

  var map;

  function initialize() {
    var mapOptions = {
      zoom: 14,
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      center: cidade
    };

    map = new google.maps.Map(document.getElementById("map_canvas"),
            mapOptions);
  }

  function drop() {
    for (var i = 0; i < veiculos.length; i++) {
      setTimeout(function() {
        addMarker();
      });
    }
  }

  function addMarker() {
	var imageLivre = new google.maps.MarkerImage('assets/green_MarkerL.png');
	var imageOcupado = new google.maps.MarkerImage('assets/red_MarkerO.png');
    markers.push(new google.maps.Marker({
      position: veiculos[iterator],
      map: map,
      draggable: false,
      icon: imageOcupado }));
    iterator++;
  }
  
 drop();
  
</script>
</head>
<body onload="initialize()">
<div id="map_canvas" style="width: 500px; height: 400px;">map div</div>

</body>
